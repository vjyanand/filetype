use serde::{Deserialize, Serialize};
use serde_wasm_bindgen::Error;
use std::{io::Read, cmp};
use wasm_bindgen::prelude::*;
use wasm_bindgen_file_reader::WebSysFile;

static JSON_EXTENSION:&'static str = r#"{"application/vnd.hzn-3d-crossword":{"d":"3D Crossword Plugin","e":".x3d"},"video/3gpp":{"d":"3GP","e":".3gp"},"video/3gpp2":{"d":"3GP2","e":".3g2"},"application/vnd.mseq":{"d":"3GPP MSEQ File","e":".mseq"},"application/vnd.3m.post-it-notes":{"d":"3M Post It Notes","e":".pwn"},"application/vnd.3gpp.pic-bw-large":{"d":"3rd Generation Partnership Project - Pic Large","e":".plb"},"application/vnd.3gpp.pic-bw-small":{"d":"3rd Generation Partnership Project - Pic Small","e":".psb"},"application/vnd.3gpp.pic-bw-var":{"d":"3rd Generation Partnership Project - Pic Var","e":".pvb"},"application/vnd.3gpp2.tcap":{"d":"3rd Generation Partnership Project - Transaction Capabilities Application Part","e":".tcap"},"application/x-7z-compressed":{"d":"7-Zip","e":".7z"},"application/x-abiword":{"d":"AbiWord","e":".abw"},"application/x-ace-compressed":{"d":"Ace Archive","e":".ace"},"application/vnd.americandynamics.acc":{"d":"Active Content Compression","e":".acc"},"application/vnd.acucobol":{"d":"ACU Cobol","e":".acu"},"application/vnd.acucorp":{"d":"ACU Cobol","e":".atc"},"audio/adpcm":{"d":"Adaptive differential pulse-code modulation","e":".adp"},"application/x-authorware-bin":{"d":"Adobe (Macropedia) Authorware - Binary File","e":".aab"},"application/x-authorware-map":{"d":"Adobe (Macropedia) Authorware - Map","e":".aam"},"application/x-authorware-seg":{"d":"Adobe (Macropedia) Authorware - Segment File","e":".aas"},"application/vnd.adobe.air-application-installer-package+zip":{"d":"Adobe AIR Application","e":".air"},"application/x-shockwave-flash":{"d":"Adobe Flash","e":".swf"},"application/vnd.adobe.fxp":{"d":"Adobe Flex Project","e":".fxp"},"application/pdf":{"d":"Adobe Portable Document Format","e":".pdf"},"application/vnd.cups-ppd":{"d":"Adobe PostScript Printer Description File Format","e":".ppd"},"application/x-director":{"d":"Adobe Shockwave Player","e":".dir"},"application/vnd.adobe.xdp+xml":{"d":"Adobe XML Data Package","e":".xdp"},"application/vnd.adobe.xfdf":{"d":"Adobe XML Forms Data Format","e":".xfdf"},"audio/x-aac":{"d":"Advanced Audio Coding (AAC)","e":".aac"},"application/vnd.ahead.space":{"d":"Ahead AIR Application","e":".ahead"},"application/vnd.airzip.filesecure.azf":{"d":"AirZip FileSECURE","e":".azf"},"application/vnd.airzip.filesecure.azs":{"d":"AirZip FileSECURE","e":".azs"},"application/vnd.amazon.ebook":{"d":"Amazon Kindle eBook format","e":".azw"},"application/vnd.amiga.ami":{"d":"AmigaDE","e":".ami"},"application/andrew-inset":{"d":"Andrew Toolkit","e":"N/A"},"application/vnd.android.package-archive":{"d":"Android Package Archive","e":".apk"},"application/vnd.anser-web-certificate-issue-initiation":{"d":"ANSER-WEB Terminal Client - Certificate Issue","e":".cii"},"application/vnd.anser-web-funds-transfer-initiation":{"d":"ANSER-WEB Terminal Client - Web Funds Transfer","e":".fti"},"application/vnd.antix.game-component":{"d":"Antix Game Player","e":".atx"},"application/x-apple-diskimage":{"d":"Apple Disk Image","e":".dmg"},"application/vnd.apple.installer+xml":{"d":"Apple Installer Package","e":".mpkg"},"application/applixware":{"d":"Applixware","e":".aw"},"application/vnd.hhe.lesson-player":{"d":"Archipelago Lesson Player","e":".les"},"application/x-freearc":{"d":"Archive document - Multiple Fils Embedded","e":".arc"},"application/vnd.aristanetworks.swi":{"d":"Arista Networks Software Image","e":".swi"},"text/x-asm":{"d":"Assembler Source File","e":".s"},"application/atomcat+xml":{"d":"Atom Publishing Protocol","e":".atomcat"},"application/atomsvc+xml":{"d":"Atom Publishing Protocol Service Document","e":".atomsvc"},"application/atom+xml":{"d":"Atom Syndication Format","e":".atom, .xml"},"application/pkix-attr-cert":{"d":"Attribute Certificate","e":".ac"},"audio/x-aiff":{"d":"Audio Interchange File Format","e":".aif"},"video/x-msvideo":{"d":"Audio Video Interleave (AVI)","e":".avi"},"application/vnd.audiograph":{"d":"Audiograph","e":".aep"},"image/vnd.dxf":{"d":"AutoCAD DXF","e":".dxf"},"model/vnd.dwf":{"d":"Autodesk Design Web Format (DWF)","e":".dwf"},"image/avif":{"d":"AV1 Image File","e":".avif"},"text/plain-bas":{"d":"BAS Partitur Format","e":".par"},"application/x-bcpio":{"d":"Binary CPIO Archive","e":".bcpio"},"application/octet-stream":{"d":"Binary Data","e":".bin"},"image/bmp":{"d":"Bitmap Image File","e":".bmp"},"application/x-bittorrent":{"d":"BitTorrent","e":".torrent"},"application/vnd.rim.cod":{"d":"Blackberry COD File","e":".cod"},"application/vnd.blueice.multipass":{"d":"Blueice Research Multipass","e":".mpm"},"application/vnd.bmi":{"d":"BMI Drawing Data Interchange","e":".bmi"},"application/x-sh":{"d":"Bourne Shell Script","e":".sh"},"image/prs.btif":{"d":"BTIF","e":".btif"},"application/vnd.businessobjects":{"d":"BusinessObjects","e":".rep"},"application/x-bzip":{"d":"Bzip Archive","e":".bz"},"application/x-bzip2":{"d":"Bzip2 Archive","e":".bz2"},"application/x-csh":{"d":"C Shell Script","e":".csh"},"text/x-c":{"d":"C Source File","e":".c"},"application/vnd.chemdraw+xml":{"d":"CambridgeSoft Chem Draw","e":".cdxml"},"text/css":{"d":"Cascading Style Sheets (CSS)","e":".css"},"application/x-cdf":{"d":"CD Audio","e":".cda"},"chemical/x-cdx":{"d":"ChemDraw eXchange file","e":".cdx"},"chemical/x-cml":{"d":"Chemical Markup Language","e":".cml"},"chemical/x-csml":{"d":"Chemical Style Markup Language","e":".csml"},"application/vnd.contact.cmsg":{"d":"CIM Database","e":".cdbcmsg"},"application/vnd.claymore":{"d":"Claymore Data Files","e":".cla"},"application/vnd.clonk.c4group":{"d":"Clonk Game","e":".c4g"},"image/vnd.dvb.subtitle":{"d":"Close Captioning - Subtitle","e":".sub"},"application/cdmi-capability":{"d":"Cloud Data Management Interface (CDMI) - Capability","e":".cdmia"},"application/cdmi-container":{"d":"Cloud Data Management Interface (CDMI) - Contaimer","e":".cdmic"},"application/cdmi-domain":{"d":"Cloud Data Management Interface (CDMI) - Domain","e":".cdmid"},"application/cdmi-object":{"d":"Cloud Data Management Interface (CDMI) - Object","e":".cdmio"},"application/cdmi-queue":{"d":"Cloud Data Management Interface (CDMI) - Queue","e":".cdmiq"},"application/vnd.cluetrust.cartomobile-config":{"d":"ClueTrust CartoMobile - Config","e":".c11amc"},"application/vnd.cluetrust.cartomobile-config-pkg":{"d":"ClueTrust CartoMobile - Config Package","e":".c11amz"},"image/x-cmu-raster":{"d":"CMU Image","e":".ras"},"model/vnd.collada+xml":{"d":"COLLADA","e":".dae"},"text/csv":{"d":"Comma-Seperated Values","e":".csv"},"application/mac-compactpro":{"d":"Compact Pro","e":".cpt"},"application/vnd.wap.wmlc":{"d":"Compiled Wireless Markup Language (WMLC)","e":".wmlc"},"image/cgm":{"d":"Computer Graphics Metafile","e":".cgm"},"x-conference/x-cooltalk":{"d":"CoolTalk","e":".ice"},"image/x-cmx":{"d":"Corel Metafile Exchange (CMX)","e":".cmx"},"application/vnd.xara":{"d":"CorelXARA","e":".xar"},"application/vnd.cosmocaller":{"d":"CosmoCaller","e":".cmc"},"application/x-cpio":{"d":"CPIO Archive","e":".cpio"},"application/vnd.crick.clicker":{"d":"CrickSoftware - Clicker","e":".clkx"},"application/vnd.crick.clicker.keyboard":{"d":"CrickSoftware - Clicker - Keyboard","e":".clkk"},"application/vnd.crick.clicker.palette":{"d":"CrickSoftware - Clicker - Palette","e":".clkp"},"application/vnd.crick.clicker.template":{"d":"CrickSoftware - Clicker - Template","e":".clkt"},"application/vnd.crick.clicker.wordbank":{"d":"CrickSoftware - Clicker - Wordbank","e":".clkw"},"application/vnd.criticaltools.wbs+xml":{"d":"Critical Tools - PERT Chart EXPERT","e":".wbs"},"application/vnd.rig.cryptonote":{"d":"CryptoNote","e":".cryptonote"},"chemical/x-cif":{"d":"Crystallographic Interchange Format","e":".cif"},"chemical/x-cmdf":{"d":"CrystalMaker Data Format","e":".cmdf"},"application/cu-seeme":{"d":"CU-SeeMe","e":".cu"},"application/prs.cww":{"d":"CU-Writer","e":".cww"},"text/vnd.curl":{"d":"Curl - Applet","e":".curl"},"text/vnd.curl.dcurl":{"d":"Curl - Detached Applet","e":".dcurl"},"text/vnd.curl.mcurl":{"d":"Curl - Manifest File","e":".mcurl"},"text/vnd.curl.scurl":{"d":"Curl - Source Code","e":".scurl"},"application/vnd.curl.car":{"d":"CURL Applet","e":".car"},"application/vnd.curl.pcurl":{"d":"CURL Applet","e":".pcurl"},"application/vnd.yellowriver-custom-menu":{"d":"CustomMenu","e":".cmp"},"application/dssc+der":{"d":"Data Structure for the Security Suitability of Cryptographic Algorithms","e":".dssc"},"application/dssc+xml":{"d":"Data Structure for the Security Suitability of Cryptographic Algorithms","e":".xdssc"},"application/x-debian-package":{"d":"Debian Package","e":".deb"},"audio/vnd.dece.audio":{"d":"DECE Audio","e":".uva"},"image/vnd.dece.graphic":{"d":"DECE Graphic","e":".uvi"},"video/vnd.dece.hd":{"d":"DECE High Definition Video","e":".uvh"},"video/vnd.dece.mobile":{"d":"DECE Mobile Video","e":".uvm"},"video/vnd.uvvu.mp4":{"d":"DECE MP4","e":".uvu"},"video/vnd.dece.pd":{"d":"DECE PD Video","e":".uvp"},"video/vnd.dece.sd":{"d":"DECE SD Video","e":".uvs"},"video/vnd.dece.video":{"d":"DECE Video","e":".uvv"},"application/x-dvi":{"d":"Device Independent File Format (DVI)","e":".dvi"},"application/vnd.fdsn.seed":{"d":"Digital Siesmograph Networks - SEED Datafiles","e":".seed"},"application/x-dtbook+xml":{"d":"Digital Talking Book","e":".dtb"},"application/x-dtbresource+xml":{"d":"Digital Talking Book - Resource File","e":".res"},"application/vnd.dvb.ait":{"d":"Digital Video Broadcasting","e":".ait"},"application/vnd.dvb.service":{"d":"Digital Video Broadcasting","e":".svc"},"audio/vnd.digital-winds":{"d":"Digital Winds Music","e":".eol"},"image/vnd.djvu":{"d":"DjVu","e":".djvu"},"application/xml-dtd":{"d":"Document Type Definition","e":".dtd"},"application/vnd.dolby.mlp":{"d":"Dolby Meridian Lossless Packing","e":".mlp"},"application/x-doom":{"d":"Doom Video Game","e":".wad"},"application/vnd.dpgraph":{"d":"DPGraph","e":".dpg"},"audio/vnd.dra":{"d":"DRA Audio","e":".dra"},"application/vnd.dreamfactory":{"d":"DreamFactory","e":".dfac"},"audio/vnd.dts":{"d":"DTS Audio","e":".dts"},"audio/vnd.dts.hd":{"d":"DTS High Definition Audio","e":".dtshd"},"image/vnd.dwg":{"d":"DWG Drawing","e":".dwg"},"application/vnd.dynageo":{"d":"DynaGeo","e":".geo"},"application/ecmascript":{"d":"ECMAScript","e":".es"},"application/vnd.ecowin.chart":{"d":"EcoWin Chart","e":".mag"},"image/vnd.fujixerox.edmics-mmr":{"d":"EDMICS 2000","e":".mmr"},"image/vnd.fujixerox.edmics-rlc":{"d":"EDMICS 2000","e":".rlc"},"application/exi":{"d":"Efficient XML Interchange","e":".exi"},"application/vnd.proteus.magazine":{"d":"EFI Proteus","e":".mgz"},"application/epub+zip":{"d":"Electronic Publication","e":".epub"},"message/rfc822":{"d":"Email Message","e":".eml"},"application/vnd.enliven":{"d":"Enliven Viewer","e":".nml"},"application/vnd.is-xpr":{"d":"Express by Infoseek","e":".xpr"},"image/vnd.xiff":{"d":"eXtended Image File Format (XIFF)","e":".xif"},"application/vnd.xfdl":{"d":"Extensible Forms Description Language","e":".xfdl"},"application/emma+xml":{"d":"Extensible MultiModal Annotation","e":".emma"},"application/vnd.ezpix-album":{"d":"EZPix Secure Photo Album","e":".ez2"},"application/vnd.ezpix-package":{"d":"EZPix Secure Photo Album","e":".ez3"},"image/vnd.fst":{"d":"FAST Search & Transfer ASA","e":".fst"},"video/vnd.fvt":{"d":"FAST Search & Transfer ASA","e":".fvt"},"image/vnd.fastbidsheet":{"d":"FastBid Sheet","e":".fbs"},"application/vnd.denovo.fcselayout-link":{"d":"FCS Express Layout Link","e":".fe_launch"},"video/x-f4v":{"d":"Flash Video","e":".f4v"},"video/x-flv":{"d":"Flash Video","e":".flv"},"image/vnd.fpx":{"d":"FlashPix","e":".fpx"},"image/vnd.net-fpx":{"d":"FlashPix","e":".npx"},"text/vnd.fmi.flexstor":{"d":"FLEXSTOR","e":".flx"},"video/x-fli":{"d":"FLI/FLC Animation Format","e":".fli"},"application/vnd.fluxtime.clip":{"d":"FluxTime Clip","e":".ftc"},"application/vnd.fdf":{"d":"Forms Data Format","e":".fdf"},"text/x-fortran":{"d":"Fortran Source File","e":".f"},"application/vnd.mif":{"d":"FrameMaker Interchange Format","e":".mif"},"application/vnd.framemaker":{"d":"FrameMaker Normal Format","e":".fm"},"image/x-freehand":{"d":"FreeHand MX","e":".fh"},"application/vnd.fsc.weblaunch":{"d":"Friendly Software Corporation","e":".fsc"},"application/vnd.frogans.fnc":{"d":"Frogans Player","e":".fnc"},"application/vnd.frogans.ltf":{"d":"Frogans Player","e":".ltf"},"application/vnd.fujixerox.ddd":{"d":"Fujitsu - Xerox 2D CAD Data","e":".ddd"},"application/vnd.fujixerox.docuworks":{"d":"Fujitsu - Xerox DocuWorks","e":".xdw"},"application/vnd.fujixerox.docuworks.binder":{"d":"Fujitsu - Xerox DocuWorks Binder","e":".xbd"},"application/vnd.fujitsu.oasys":{"d":"Fujitsu Oasys","e":".oas"},"application/vnd.fujitsu.oasys2":{"d":"Fujitsu Oasys","e":".oa2"},"application/vnd.fujitsu.oasys3":{"d":"Fujitsu Oasys","e":".oa3"},"application/vnd.fujitsu.oasysgp":{"d":"Fujitsu Oasys","e":".fg5"},"application/vnd.fujitsu.oasysprs":{"d":"Fujitsu Oasys","e":".bh2"},"application/x-futuresplash":{"d":"FutureSplash Animator","e":".spl"},"application/vnd.fuzzysheet":{"d":"FuzzySheet","e":".fzs"},"image/g3fax":{"d":"G3 Fax Image","e":".g3"},"application/vnd.gmx":{"d":"GameMaker ActiveX","e":".gmx"},"model/vnd.gtw":{"d":"Gen-Trix Studio","e":".gtw"},"application/vnd.genomatix.tuxedo":{"d":"Genomatix Tuxedo Framework","e":".txd"},"application/vnd.geogebra.file":{"d":"GeoGebra","e":".ggb"},"application/vnd.geogebra.tool":{"d":"GeoGebra","e":".ggt"},"model/vnd.gdl":{"d":"Geometric Description Language (GDL)","e":".gdl"},"application/vnd.geometry-explorer":{"d":"GeoMetry Explorer","e":".gex"},"application/vnd.geonext":{"d":"GEONExT and JSXGraph","e":".gxt"},"application/vnd.geoplan":{"d":"GeoplanW","e":".g2w"},"application/vnd.geospace":{"d":"GeospacW","e":".g3w"},"application/x-font-ghostscript":{"d":"Ghostscript Font","e":".gsf"},"application/x-font-bdf":{"d":"Glyph Bitmap Distribution Format","e":".bdf"},"application/x-gtar":{"d":"GNU Tar Files","e":".gtar"},"application/x-texinfo":{"d":"GNU Texinfo Document","e":".texinfo"},"application/x-gnumeric":{"d":"Gnumeric","e":".gnumeric"},"application/vnd.google-earth.kml+xml":{"d":"Google Earth - KML","e":".kml"},"application/vnd.google-earth.kmz":{"d":"Google Earth - Zipped KML","e":".kmz"},"application/gpx+xml":{"d":"GPS eXchange Format","e":".gpx"},"application/vnd.grafeq":{"d":"GrafEq","e":".gqf"},"image/gif":{"d":"Graphics Interchange Format","e":".gif"},"text/vnd.graphviz":{"d":"Graphviz","e":".gv"},"application/vnd.groove-account":{"d":"Groove - Account","e":".gac"},"application/vnd.groove-help":{"d":"Groove - Help","e":".ghf"},"application/vnd.groove-identity-message":{"d":"Groove - Identity Message","e":".gim"},"application/vnd.groove-injector":{"d":"Groove - Injector","e":".grv"},"application/vnd.groove-tool-message":{"d":"Groove - Tool Message","e":".gtm"},"application/vnd.groove-tool-template":{"d":"Groove - Tool Template","e":".tpl"},"application/vnd.groove-vcard":{"d":"Groove - Vcard","e":".vcg"},"application/gzip":{"d":"GZip","e":".gz"},"video/h261":{"d":"H.261","e":".h261"},"video/h263":{"d":"H.263","e":".h263"},"video/h264":{"d":"H.264","e":".h264"},"application/vnd.hp-hpid":{"d":"Hewlett Packard Instant Delivery","e":".hpid"},"application/vnd.hp-hps":{"d":"Hewlett-Packard's WebPrintSmart","e":".hps"},"application/x-hdf":{"d":"Hierarchical Data Format","e":".hdf"},"audio/vnd.rip":{"d":"Hit'n'Mix","e":".rip"},"application/vnd.hbci":{"d":"Homebanking Computer Interface (HBCI)","e":".hbci"},"application/vnd.hp-jlyt":{"d":"HP Indigo Digital Press - Job Layout Languate","e":".jlt"},"application/vnd.hp-pcl":{"d":"HP Printer Command Language","e":".pcl"},"application/vnd.hp-hpgl":{"d":"HP-GL/2 and HP RTL","e":".hpgl"},"application/vnd.yamaha.hv-script":{"d":"HV Script","e":".hvs"},"application/vnd.yamaha.hv-dic":{"d":"HV Voice Dictionary","e":".hvd"},"application/vnd.yamaha.hv-voice":{"d":"HV Voice Parameter","e":".hvp"},"application/vnd.hydrostatix.sof-data":{"d":"Hydrostatix Master Suite","e":".sfd-hdstx"},"application/hyperstudio":{"d":"Hyperstudio","e":".stk"},"application/vnd.hal+xml":{"d":"Hypertext Application Language","e":".hal"},"text/html":{"d":"HyperText Markup Language (HTML)","e":".html"},"application/vnd.ibm.rights-management":{"d":"IBM DB2 Rights Manager","e":".irm"},"application/vnd.ibm.secure-container":{"d":"IBM Electronic Media Management System - Secure Container","e":".sc"},"text/calendar":{"d":"iCalendar","e":".ics"},"application/vnd.iccprofile":{"d":"ICC profile","e":".icc"},"image/x-icon":{"d":"Icon Image","e":".ico"},"application/vnd.igloader":{"d":"igLoader","e":".igl"},"image/ief":{"d":"Image Exchange Format","e":".ief"},"application/vnd.immervision-ivp":{"d":"ImmerVision PURE Players","e":".ivp"},"application/vnd.immervision-ivu":{"d":"ImmerVision PURE Players","e":".ivu"},"application/reginfo+xml":{"d":"IMS Networks","e":".rif"},"text/vnd.in3d.3dml":{"d":"In3D - 3DML","e":".3dml"},"text/vnd.in3d.spot":{"d":"In3D - 3DML","e":".spot"},"model/iges":{"d":"Initial Graphics Exchange Specification (IGES)","e":".igs"},"application/vnd.intergeo":{"d":"Interactive Geometry Software","e":".i2g"},"application/vnd.cinderella":{"d":"Interactive Geometry Software Cinderella","e":".cdy"},"application/vnd.intercon.formnet":{"d":"Intercon FormNet","e":".xpw"},"application/vnd.isac.fcs":{"d":"International Society for Advancement of Cytometry","e":".fcs"},"application/ipfix":{"d":"Internet Protocol Flow Information Export","e":".ipfix"},"application/pkix-cert":{"d":"Internet Public Key Infrastructure - Certificate","e":".cer"},"application/pkixcmp":{"d":"Internet Public Key Infrastructure - Certificate Management Protocole","e":".pki"},"application/pkix-crl":{"d":"Internet Public Key Infrastructure - Certificate Revocation Lists","e":".crl"},"application/pkix-pkipath":{"d":"Internet Public Key Infrastructure - Certification Path","e":".pkipath"},"application/vnd.insors.igm":{"d":"IOCOM Visimeet","e":".igm"},"application/vnd.ipunplugged.rcprofile":{"d":"IP Unplugged Roaming Client","e":".rcprofile"},"application/vnd.irepository.package+xml":{"d":"iRepository / Lucidoc Editor","e":".irp"},"text/vnd.sun.j2me.app-descriptor":{"d":"J2ME App Descriptor","e":".jad"},"application/java-archive":{"d":"Java Archive","e":".jar"},"application/java-vm":{"d":"Java Bytecode File","e":".class"},"application/x-java-jnlp-file":{"d":"Java Network Launching Protocol","e":".jnlp"},"application/java-serialized-object":{"d":"Java Serialized Object","e":".ser"},"text/x-java-source,java":{"d":"Java Source File","e":".java"},"application/javascript":{"d":"JavaScript","e":".js"},"text/javascript":{"d":"JavaScript Module","e":".mjs"},"application/json":{"d":"JavaScript Object Notation (JSON)","e":".json"},"application/vnd.joost.joda-archive":{"d":"Joda Archive","e":".joda"},"video/jpm":{"d":"JPEG 2000 Compound Image File Format","e":".jpm"},"image/jpeg":{"d":"JPEG Image","e":".jpeg, .jpg"},"image/x-citrix-jpeg":{"d":"JPEG Image (Citrix client)","e":".jpeg, .jpg"},"image/pjpeg":{"d":"JPEG Image (Progressive)","e":".pjpeg"},"video/jpeg":{"d":"JPGVideo","e":".jpgv"},"application/ld+json":{"d":"JSON - Linked Data","e":".jsonld"},"application/vnd.kahootz":{"d":"Kahootz","e":".ktz"},"application/vnd.chipnuts.karaoke-mmd":{"d":"Karaoke on Chipnuts Chipsets","e":".mmd"},"application/vnd.kde.karbon":{"d":"KDE KOffice Office Suite - Karbon","e":".karbon"},"application/vnd.kde.kchart":{"d":"KDE KOffice Office Suite - KChart","e":".chrt"},"application/vnd.kde.kformula":{"d":"KDE KOffice Office Suite - Kformula","e":".kfo"},"application/vnd.kde.kivio":{"d":"KDE KOffice Office Suite - Kivio","e":".flw"},"application/vnd.kde.kontour":{"d":"KDE KOffice Office Suite - Kontour","e":".kon"},"application/vnd.kde.kpresenter":{"d":"KDE KOffice Office Suite - Kpresenter","e":".kpr"},"application/vnd.kde.kspread":{"d":"KDE KOffice Office Suite - Kspread","e":".ksp"},"application/vnd.kde.kword":{"d":"KDE KOffice Office Suite - Kword","e":".kwd"},"application/vnd.kenameaapp":{"d":"Kenamea App","e":".htke"},"application/vnd.kidspiration":{"d":"Kidspiration","e":".kia"},"application/vnd.kinar":{"d":"Kinar Applications","e":".kne"},"application/vnd.kodak-descriptor":{"d":"Kodak Storyshare","e":".sse"},"application/vnd.las.las+xml":{"d":"Laser App Enterprise","e":".lasxml"},"application/x-latex":{"d":"LaTeX","e":".latex"},"application/vnd.llamagraphics.life-balance.desktop":{"d":"Life Balance - Desktop Edition","e":".lbd"},"application/vnd.llamagraphics.life-balance.exchange+xml":{"d":"Life Balance - Exchange Format","e":".lbe"},"application/vnd.jam":{"d":"Lightspeed Audio Lab","e":".jam"},"application/vnd.lotus-1-2-3":{"d":"Lotus 1-2-3","e":"0.123"},"application/vnd.lotus-approach":{"d":"Lotus Approach","e":".apr"},"application/vnd.lotus-freelance":{"d":"Lotus Freelance","e":".pre"},"application/vnd.lotus-notes":{"d":"Lotus Notes","e":".nsf"},"application/vnd.lotus-organizer":{"d":"Lotus Organizer","e":".org"},"application/vnd.lotus-screencam":{"d":"Lotus Screencam","e":".scm"},"application/vnd.lotus-wordpro":{"d":"Lotus Wordpro","e":".lwp"},"audio/vnd.lucent.voice":{"d":"Lucent Voice","e":".lvp"},"audio/x-mpegurl":{"d":"M3U (Multimedia Playlist)","e":".m3u"},"video/x-m4v":{"d":"M4v","e":".m4v"},"application/mac-binhex40":{"d":"Macintosh BinHex 4.0","e":".hqx"},"application/vnd.macports.portpkg":{"d":"MacPorts Port System","e":".portpkg"},"application/vnd.osgeo.mapguide.package":{"d":"MapGuide DBXML","e":".mgp"},"application/marc":{"d":"MARC Formats","e":".mrc"},"application/marcxml+xml":{"d":"MARC21 XML Schema","e":".mrcx"},"application/mxf":{"d":"Material Exchange Format","e":".mxf"},"application/vnd.wolfram.player":{"d":"Mathematica Notebook Player","e":".nbp"},"application/mathematica":{"d":"Mathematica Notebooks","e":".ma"},"application/mathml+xml":{"d":"Mathematical Markup Language","e":".mathml"},"application/mbox":{"d":"Mbox database files","e":".mbox"},"application/vnd.medcalcdata":{"d":"MedCalc","e":".mc1"},"application/mediaservercontrol+xml":{"d":"Media Server Control Markup Language","e":".mscml"},"application/vnd.mediastation.cdkey":{"d":"MediaRemote","e":".cdkey"},"application/vnd.mfer":{"d":"Medical Waveform Encoding Format","e":".mwf"},"application/vnd.mfmp":{"d":"Melody Format for Mobile Platform","e":".mfm"},"model/mesh":{"d":"Mesh Data Type","e":".msh"},"application/mads+xml":{"d":"Metadata Authority Description Schema","e":".mads"},"application/mets+xml":{"d":"Metadata Encoding and Transmission Standard","e":".mets"},"application/mods+xml":{"d":"Metadata Object Description Schema","e":".mods"},"application/metalink4+xml":{"d":"Metalink","e":".meta4"},"application/vnd.mcd":{"d":"Micro CADAM Helix D&D","e":".mcd"},"application/vnd.micrografx.flo":{"d":"Micrografx","e":".flo"},"application/vnd.micrografx.igx":{"d":"Micrografx iGrafx Professional","e":".igx"},"application/vnd.eszigno3+xml":{"d":"MICROSEC e-Szign�","e":".es3"},"application/x-msaccess":{"d":"Microsoft Access","e":".mdb"},"video/x-ms-asf":{"d":"Microsoft Advanced Systems Format (ASF)","e":".asf"},"application/x-msdownload":{"d":"Microsoft Application","e":".exe"},"application/vnd.ms-artgalry":{"d":"Microsoft Artgalry","e":".cil"},"application/vnd.ms-cab-compressed":{"d":"Microsoft Cabinet File","e":".cab"},"application/vnd.ms-ims":{"d":"Microsoft Class Server","e":".ims"},"application/x-ms-application":{"d":"Microsoft ClickOnce","e":".application"},"application/x-msclip":{"d":"Microsoft Clipboard Clip","e":".clp"},"image/vnd.ms-modi":{"d":"Microsoft Document Imaging Format","e":".mdi"},"application/vnd.ms-fontobject":{"d":"Microsoft Embedded OpenType","e":".eot"},"application/vnd.ms-excel":{"d":"Microsoft Excel","e":".xls"},"application/vnd.ms-excel.addin.macroenabled.12":{"d":"Microsoft Excel - Add-In File","e":".xlam"},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{"d":"Microsoft Excel - Binary Workbook","e":".xlsb"},"application/vnd.ms-excel.template.macroenabled.12":{"d":"Microsoft Excel - Macro-Enabled Template File","e":".xltm"},"application/vnd.ms-excel.sheet.macroenabled.12":{"d":"Microsoft Excel - Macro-Enabled Workbook","e":".xlsm"},"application/vnd.ms-htmlhelp":{"d":"Microsoft Html Help File","e":".chm"},"application/x-mscardfile":{"d":"Microsoft Information Card","e":".crd"},"application/vnd.ms-lrm":{"d":"Microsoft Learning Resource Module","e":".lrm"},"application/x-msmediaview":{"d":"Microsoft MediaView","e":".mvb"},"application/x-msmoney":{"d":"Microsoft Money","e":".mny"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{"d":"Microsoft Office - OOXML - Presentation","e":".pptx"},"application/vnd.openxmlformats-officedocument.presentationml.slide":{"d":"Microsoft Office - OOXML - Presentation (Slide)","e":".sldx"},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{"d":"Microsoft Office - OOXML - Presentation (Slideshow)","e":".ppsx"},"application/vnd.openxmlformats-officedocument.presentationml.template":{"d":"Microsoft Office - OOXML - Presentation Template","e":".potx"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{"d":"Microsoft Office - OOXML - Spreadsheet","e":".xlsx"},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{"d":"Microsoft Office - OOXML - Spreadsheet Template","e":".xltx"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{"d":"Microsoft Office - OOXML - Word Document","e":".docx"},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{"d":"Microsoft Office - OOXML - Word Document Template","e":".dotx"},"application/x-msbinder":{"d":"Microsoft Office Binder","e":".obd"},"application/vnd.ms-officetheme":{"d":"Microsoft Office System Release Theme","e":".thmx"},"application/onenote":{"d":"Microsoft OneNote","e":".onetoc"},"audio/vnd.ms-playready.media.pya":{"d":"Microsoft PlayReady Ecosystem","e":".pya"},"video/vnd.ms-playready.media.pyv":{"d":"Microsoft PlayReady Ecosystem Video","e":".pyv"},"application/vnd.ms-powerpoint":{"d":"Microsoft PowerPoint","e":".ppt"},"application/vnd.ms-powerpoint.addin.macroenabled.12":{"d":"Microsoft PowerPoint - Add-in file","e":".ppam"},"application/vnd.ms-powerpoint.slide.macroenabled.12":{"d":"Microsoft PowerPoint - Macro-Enabled Open XML Slide","e":".sldm"},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{"d":"Microsoft PowerPoint - Macro-Enabled Presentation File","e":".pptm"},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{"d":"Microsoft PowerPoint - Macro-Enabled Slide Show File","e":".ppsm"},"application/vnd.ms-powerpoint.template.macroenabled.12":{"d":"Microsoft PowerPoint - Macro-Enabled Template File","e":".potm"},"application/vnd.ms-project":{"d":"Microsoft Project","e":".mpp"},"application/x-mspublisher":{"d":"Microsoft Publisher","e":".pub"},"application/x-msschedule":{"d":"Microsoft Schedule+","e":".scd"},"application/x-silverlight-app":{"d":"Microsoft Silverlight","e":".xap"},"application/vnd.ms-pki.stl":{"d":"Microsoft Trust UI Provider - Certificate Trust Link","e":".stl"},"application/vnd.ms-pki.seccat":{"d":"Microsoft Trust UI Provider - Security Catalog","e":".cat"},"application/vnd.visio":{"d":"Microsoft Visio","e":".vsd"},"application/vnd.visio2013":{"d":"Microsoft Visio 2013","e":".vsdx"},"video/x-ms-wm":{"d":"Microsoft Windows Media","e":".wm"},"audio/x-ms-wma":{"d":"Microsoft Windows Media Audio","e":".wma"},"audio/x-ms-wax":{"d":"Microsoft Windows Media Audio Redirector","e":".wax"},"video/x-ms-wmx":{"d":"Microsoft Windows Media Audio/Video Playlist","e":".wmx"},"application/x-ms-wmd":{"d":"Microsoft Windows Media Player Download Package","e":".wmd"},"application/vnd.ms-wpl":{"d":"Microsoft Windows Media Player Playlist","e":".wpl"},"application/x-ms-wmz":{"d":"Microsoft Windows Media Player Skin Package","e":".wmz"},"video/x-ms-wmv":{"d":"Microsoft Windows Media Video","e":".wmv"},"video/x-ms-wvx":{"d":"Microsoft Windows Media Video Playlist","e":".wvx"},"application/x-msmetafile":{"d":"Microsoft Windows Metafile","e":".wmf"},"application/x-msterminal":{"d":"Microsoft Windows Terminal Services","e":".trm"},"application/msword":{"d":"Microsoft Word","e":".doc"},"application/vnd.ms-word.document.macroenabled.12":{"d":"Microsoft Word - Macro-Enabled Document","e":".docm"},"application/vnd.ms-word.template.macroenabled.12":{"d":"Microsoft Word - Macro-Enabled Template","e":".dotm"},"application/x-mswrite":{"d":"Microsoft Wordpad","e":".wri"},"application/vnd.ms-works":{"d":"Microsoft Works","e":".wps"},"application/x-ms-xbap":{"d":"Microsoft XAML Browser Application","e":".xbap"},"application/vnd.ms-xpsdocument":{"d":"Microsoft XML Paper Specification","e":".xps"},"audio/midi":{"d":"MIDI","e":".midi, .mid"},"application/vnd.ibm.minipay":{"d":"MiniPay","e":".mpy"},"application/vnd.ibm.modcap":{"d":"MO:DCA-P","e":".afp"},"application/vnd.jcp.javame.midlet-rms":{"d":"Mobile Information Device Profile","e":".rms"},"application/vnd.tmobile-livetv":{"d":"MobileTV","e":".tmo"},"application/x-mobipocket-ebook":{"d":"Mobipocket","e":".prc"},"application/vnd.mobius.mbk":{"d":"Mobius Management Systems - Basket file","e":".mbk"},"application/vnd.mobius.dis":{"d":"Mobius Management Systems - Distribution Database","e":".dis"},"application/vnd.mobius.plc":{"d":"Mobius Management Systems - Policy Definition Language File","e":".plc"},"application/vnd.mobius.mqy":{"d":"Mobius Management Systems - Query File","e":".mqy"},"application/vnd.mobius.msl":{"d":"Mobius Management Systems - Script Language","e":".msl"},"application/vnd.mobius.txf":{"d":"Mobius Management Systems - Topic Index File","e":".txf"},"application/vnd.mobius.daf":{"d":"Mobius Management Systems - UniversalArchive","e":".daf"},"text/vnd.fly":{"d":"mod_fly / fly.cgi","e":".fly"},"application/vnd.mophun.certificate":{"d":"Mophun Certificate","e":".mpc"},"application/vnd.mophun.application":{"d":"Mophun VM","e":".mpn"},"video/mj2":{"d":"Motion JPEG 2000","e":".mj2"},"audio/mpeg":{"d":"MPEG Audio","e":".mpga"},"video/mp2t":{"d":"MPEG Transport Stream","e":".ts"},"video/vnd.mpegurl":{"d":"MPEG Url","e":".mxu"},"video/mpeg":{"d":"MPEG Video","e":".mpeg"},"application/mp21":{"d":"MPEG-21","e":".m21"},"audio/mp4":{"d":"MPEG-4 Audio","e":".mp4a"},"video/mp4":{"d":"MPEG-4 Video","e":".mp4"},"application/mp4":{"d":"MPEG4","e":".mp4"},"application/vnd.apple.mpegurl":{"d":"Multimedia Playlist Unicode","e":".m3u8"},"application/vnd.musician":{"d":"MUsical Score Interpreted Code Invented for the ASCII designation of Notation","e":".mus"},"application/vnd.muvee.style":{"d":"Muvee Automatic Video Editing","e":".msty"},"application/xv+xml":{"d":"MXML","e":".mxml"},"application/vnd.nokia.n-gage.data":{"d":"N-Gage Game Data","e":".ngdat"},"application/vnd.nokia.n-gage.symbian.install":{"d":"N-Gage Game Installer","e":".n-gage"},"application/x-dtbncx+xml":{"d":"Navigation Control file for XML (for ePub)","e":".ncx"},"application/x-netcdf":{"d":"Network Common Data Form (NetCDF)","e":".nc"},"application/vnd.neurolanguage.nlu":{"d":"neuroLanguage","e":".nlu"},"application/vnd.dna":{"d":"New Moon Liftoff/DNA","e":".dna"},"application/vnd.noblenet-directory":{"d":"NobleNet Directory","e":".nnd"},"application/vnd.noblenet-sealer":{"d":"NobleNet Sealer","e":".nns"},"application/vnd.noblenet-web":{"d":"NobleNet Web","e":".nnw"},"application/vnd.nokia.radio-preset":{"d":"Nokia Radio Application - Preset","e":".rpst"},"application/vnd.nokia.radio-presets":{"d":"Nokia Radio Application - Preset","e":".rpss"},"text/n3":{"d":"Notation3","e":".n3"},"application/vnd.novadigm.edm":{"d":"Novadigm's RADIA and EDM products","e":".edm"},"application/vnd.novadigm.edx":{"d":"Novadigm's RADIA and EDM products","e":".edx"},"application/vnd.novadigm.ext":{"d":"Novadigm's RADIA and EDM products","e":".ext"},"application/vnd.flographit":{"d":"NpGraphIt","e":".gph"},"audio/vnd.nuera.ecelp4800":{"d":"Nuera ECELP 4800","e":".ecelp4800"},"audio/vnd.nuera.ecelp7470":{"d":"Nuera ECELP 7470","e":".ecelp7470"},"audio/vnd.nuera.ecelp9600":{"d":"Nuera ECELP 9600","e":".ecelp9600"},"application/oda":{"d":"Office Document Architecture","e":".oda"},"application/ogg":{"d":"Ogg","e":".ogx"},"audio/ogg":{"d":"Ogg Audio","e":".oga"},"video/ogg":{"d":"Ogg Video","e":".ogv"},"application/vnd.oma.dd2+xml":{"d":"OMA Download Agents","e":".dd2"},"application/vnd.oasis.opendocument.text-web":{"d":"Open Document Text Web","e":".oth"},"application/oebps-package+xml":{"d":"Open eBook Publication Structure","e":".opf"},"application/vnd.intu.qbo":{"d":"Open Financial Exchange","e":".qbo"},"application/vnd.openofficeorg.extension":{"d":"Open Office Extension","e":".oxt"},"application/vnd.yamaha.openscoreformat":{"d":"Open Score Format","e":".osf"},"audio/webm":{"d":"Open Web Media Project - Audio","e":".weba"},"video/webm":{"d":"Open Web Media Project - Video","e":".webm"},"application/vnd.oasis.opendocument.chart":{"d":"OpenDocument Chart","e":".odc"},"application/vnd.oasis.opendocument.chart-template":{"d":"OpenDocument Chart Template","e":".otc"},"application/vnd.oasis.opendocument.database":{"d":"OpenDocument Database","e":".odb"},"application/vnd.oasis.opendocument.formula":{"d":"OpenDocument Formula","e":".odf"},"application/vnd.oasis.opendocument.formula-template":{"d":"OpenDocument Formula Template","e":".odft"},"application/vnd.oasis.opendocument.graphics":{"d":"OpenDocument Graphics","e":".odg"},"application/vnd.oasis.opendocument.graphics-template":{"d":"OpenDocument Graphics Template","e":".otg"},"application/vnd.oasis.opendocument.image":{"d":"OpenDocument Image","e":".odi"},"application/vnd.oasis.opendocument.image-template":{"d":"OpenDocument Image Template","e":".oti"},"application/vnd.oasis.opendocument.presentation":{"d":"OpenDocument Presentation","e":".odp"},"application/vnd.oasis.opendocument.presentation-template":{"d":"OpenDocument Presentation Template","e":".otp"},"application/vnd.oasis.opendocument.spreadsheet":{"d":"OpenDocument Spreadsheet","e":".ods"},"application/vnd.oasis.opendocument.spreadsheet-template":{"d":"OpenDocument Spreadsheet Template","e":".ots"},"application/vnd.oasis.opendocument.text":{"d":"OpenDocument Text","e":".odt"},"application/vnd.oasis.opendocument.text-master":{"d":"OpenDocument Text Master","e":".odm"},"application/vnd.oasis.opendocument.text-template":{"d":"OpenDocument Text Template","e":".ott"},"image/ktx":{"d":"OpenGL Textures (KTX)","e":".ktx"},"application/vnd.sun.xml.calc":{"d":"OpenOffice - Calc (Spreadsheet)","e":".sxc"},"application/vnd.sun.xml.calc.template":{"d":"OpenOffice - Calc Template (Spreadsheet)","e":".stc"},"application/vnd.sun.xml.draw":{"d":"OpenOffice - Draw (Graphics)","e":".sxd"},"application/vnd.sun.xml.draw.template":{"d":"OpenOffice - Draw Template (Graphics)","e":".std"},"application/vnd.sun.xml.impress":{"d":"OpenOffice - Impress (Presentation)","e":".sxi"},"application/vnd.sun.xml.impress.template":{"d":"OpenOffice - Impress Template (Presentation)","e":".sti"},"application/vnd.sun.xml.math":{"d":"OpenOffice - Math (Formula)","e":".sxm"},"application/vnd.sun.xml.writer":{"d":"OpenOffice - Writer (Text - HTML)","e":".sxw"},"application/vnd.sun.xml.writer.global":{"d":"OpenOffice - Writer (Text - HTML)","e":".sxg"},"application/vnd.sun.xml.writer.template":{"d":"OpenOffice - Writer Template (Text - HTML)","e":".stw"},"application/x-font-otf":{"d":"OpenType Font File","e":".otf"},"audio/opus":{"d":"Opus Audio","e":".opus"},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{"d":"OSFPVG","e":".osfpvg"},"application/vnd.osgi.dp":{"d":"OSGi Deployment Package","e":".dp"},"application/vnd.palm":{"d":"PalmOS Data","e":".pdb"},"text/x-pascal":{"d":"Pascal Source File","e":".p"},"application/vnd.pawaafile":{"d":"PawaaFILE","e":".paw"},"application/vnd.hp-pclxl":{"d":"PCL 6 Enhanced (Formely PCL XL)","e":".pclxl"},"application/vnd.picsel":{"d":"Pcsel eFIF File","e":".efif"},"image/x-pcx":{"d":"PCX Image","e":".pcx"},"image/vnd.adobe.photoshop":{"d":"Photoshop Document","e":".psd"},"application/pics-rules":{"d":"PICSRules","e":".prf"},"image/x-pict":{"d":"PICT Image","e":".pic"},"application/x-chat":{"d":"pIRCh","e":".chat"},"application/pkcs10":{"d":"PKCS #10 - Certification Request Standard","e":".p10"},"application/x-pkcs12":{"d":"PKCS #12 - Personal Information Exchange Syntax Standard","e":".p12"},"application/pkcs7-mime":{"d":"PKCS #7 - Cryptographic Message Syntax Standard","e":".p7m"},"application/pkcs7-signature":{"d":"PKCS #7 - Cryptographic Message Syntax Standard","e":".p7s"},"application/x-pkcs7-certreqresp":{"d":"PKCS #7 - Cryptographic Message Syntax Standard (Certificate Request Response)","e":".p7r"},"application/x-pkcs7-certificates":{"d":"PKCS #7 - Cryptographic Message Syntax Standard (Certificates)","e":".p7b"},"application/pkcs8":{"d":"PKCS #8 - Private-Key Information Syntax Standard","e":".p8"},"application/vnd.pocketlearn":{"d":"PocketLearn Viewers","e":".plf"},"image/x-portable-anymap":{"d":"Portable Anymap Image","e":".pnm"},"image/x-portable-bitmap":{"d":"Portable Bitmap Format","e":".pbm"},"application/x-font-pcf":{"d":"Portable Compiled Format","e":".pcf"},"application/font-tdpfr":{"d":"Portable Font Resource","e":".pfr"},"application/x-chess-pgn":{"d":"Portable Game Notation (Chess Games)","e":".pgn"},"image/x-portable-graymap":{"d":"Portable Graymap Format","e":".pgm"},"image/png":{"d":"Portable Network Graphics (PNG)","e":".png"},"image/x-citrix-png":{"d":"Portable Network Graphics (PNG) (Citrix client)","e":".png"},"image/x-png":{"d":"Portable Network Graphics (PNG) (x-token)","e":".png"},"image/x-portable-pixmap":{"d":"Portable Pixmap Format","e":".ppm"},"application/pskc+xml":{"d":"Portable Symmetric Key Container","e":".pskcxml"},"application/vnd.ctc-posml":{"d":"PosML","e":".pml"},"application/postscript":{"d":"PostScript","e":".ai"},"application/x-font-type1":{"d":"PostScript Fonts","e":".pfa"},"application/vnd.powerbuilder6":{"d":"PowerBuilder","e":".pbd"},"application/pgp-encrypted":{"d":"Pretty Good Privacy","e":".pgp"},"application/pgp-signature":{"d":"Pretty Good Privacy - Signature","e":".pgp"},"application/vnd.previewsystems.box":{"d":"Preview Systems ZipLock/VBox","e":".box"},"application/vnd.pvi.ptid1":{"d":"Princeton Video Image","e":".ptid"},"application/pls+xml":{"d":"Pronunciation Lexicon Specification","e":".pls"},"application/vnd.pg.format":{"d":"Proprietary P&G Standard Reporting System","e":".str"},"application/vnd.pg.osasli":{"d":"Proprietary P&G Standard Reporting System","e":".ei6"},"text/prs.lines.tag":{"d":"PRS Lines Tag","e":".dsc"},"application/x-font-linux-psf":{"d":"PSF Fonts","e":".psf"},"application/vnd.publishare-delta-tree":{"d":"PubliShare Objects","e":".qps"},"application/vnd.pmi.widget":{"d":"Qualcomm's Plaza Mobile Internet","e":".wg"},"application/vnd.quark.quarkxpress":{"d":"QuarkXpress","e":".qxd"},"application/vnd.epson.esf":{"d":"QUASS Stream Player","e":".esf"},"application/vnd.epson.msf":{"d":"QUASS Stream Player","e":".msf"},"application/vnd.epson.ssf":{"d":"QUASS Stream Player","e":".ssf"},"application/vnd.epson.quickanime":{"d":"QuickAnime Player","e":".qam"},"application/vnd.intu.qfx":{"d":"Quicken","e":".qfx"},"video/quicktime":{"d":"Quicktime Video","e":".qt"},"application/x-rar-compressed":{"d":"RAR Archive","e":".rar"},"audio/x-pn-realaudio":{"d":"Real Audio Sound","e":".ram"},"audio/x-pn-realaudio-plugin":{"d":"Real Audio Sound","e":".rmp"},"application/rsd+xml":{"d":"Really Simple Discovery","e":".rsd"},"application/vnd.rn-realmedia":{"d":"RealMedia","e":".rm"},"application/vnd.realvnc.bed":{"d":"RealVNC","e":".bed"},"application/vnd.recordare.musicxml":{"d":"Recordare Applications","e":".mxl"},"application/vnd.recordare.musicxml+xml":{"d":"Recordare Applications","e":".musicxml"},"application/relax-ng-compact-syntax":{"d":"Relax NG Compact Syntax","e":".rnc"},"application/vnd.data-vision.rdz":{"d":"RemoteDocs R-Viewer","e":".rdz"},"application/rdf+xml":{"d":"Resource Description Framework","e":".rdf"},"application/vnd.cloanto.rp9":{"d":"RetroPlatform Player","e":".rp9"},"application/vnd.jisp":{"d":"RhymBox","e":".jisp"},"application/rtf":{"d":"Rich Text Format","e":".rtf"},"text/richtext":{"d":"Rich Text Format (RTF)","e":".rtx"},"application/vnd.route66.link66+xml":{"d":"ROUTE 66 Location Based Services","e":".link66"},"application/rss+xml":{"d":"RSS - Really Simple Syndication","e":".rss, .xml"},"application/shf+xml":{"d":"S Hexdump Format","e":".shf"},"application/vnd.sailingtracker.track":{"d":"SailingTracker","e":".st"},"image/svg+xml":{"d":"Scalable Vector Graphics (SVG)","e":".svg"},"application/vnd.sus-calendar":{"d":"ScheduleUs","e":".sus"},"application/sru+xml":{"d":"Search/Retrieve via URL Response Format","e":".sru"},"application/set-payment-initiation":{"d":"Secure Electronic Transaction - Payment","e":".setpay"},"application/set-registration-initiation":{"d":"Secure Electronic Transaction - Registration","e":".setreg"},"application/vnd.sema":{"d":"Secured eMail","e":".sema"},"application/vnd.semd":{"d":"Secured eMail","e":".semd"},"application/vnd.semf":{"d":"Secured eMail","e":".semf"},"application/vnd.seemail":{"d":"SeeMail","e":".see"},"application/x-font-snf":{"d":"Server Normal Format","e":".snf"},"application/scvp-vp-request":{"d":"Server-Based Certificate Validation Protocol - Validation Policies - Request","e":".spq"},"application/scvp-vp-response":{"d":"Server-Based Certificate Validation Protocol - Validation Policies - Response","e":".spp"},"application/scvp-cv-request":{"d":"Server-Based Certificate Validation Protocol - Validation Request","e":".scq"},"application/scvp-cv-response":{"d":"Server-Based Certificate Validation Protocol - Validation Response","e":".scs"},"application/sdp":{"d":"Session Description Protocol","e":".sdp"},"text/x-setext":{"d":"Setext","e":".etx"},"video/x-sgi-movie":{"d":"SGI Movie","e":".movie"},"application/vnd.shana.informed.formdata":{"d":"Shana Informed Filler","e":".ifm"},"application/vnd.shana.informed.formtemplate":{"d":"Shana Informed Filler","e":".itp"},"application/vnd.shana.informed.interchange":{"d":"Shana Informed Filler","e":".iif"},"application/vnd.shana.informed.package":{"d":"Shana Informed Filler","e":".ipk"},"application/thraud+xml":{"d":"Sharing Transaction Fraud Data","e":".tfi"},"application/x-shar":{"d":"Shell Archive","e":".shar"},"image/x-rgb":{"d":"Silicon Graphics RGB Bitmap","e":".rgb"},"application/vnd.epson.salt":{"d":"SimpleAnimeLite Player","e":".slt"},"application/vnd.accpac.simply.aso":{"d":"Simply Accounting","e":".aso"},"application/vnd.accpac.simply.imp":{"d":"Simply Accounting - Data Import","e":".imp"},"application/vnd.simtech-mindmapper":{"d":"SimTech MindMapper","e":".twd"},"application/vnd.commonspace":{"d":"Sixth Floor Media - CommonSpace","e":".csp"},"application/vnd.yamaha.smaf-audio":{"d":"SMAF Audio","e":".saf"},"application/vnd.smaf":{"d":"SMAF File","e":".mmf"},"application/vnd.yamaha.smaf-phrase":{"d":"SMAF Phrase","e":".spf"},"application/vnd.smart.teacher":{"d":"SMART Technologies Apps","e":".teacher"},"application/vnd.svd":{"d":"SourceView Document","e":".svd"},"application/sparql-query":{"d":"SPARQL - Query","e":".rq"},"application/sparql-results+xml":{"d":"SPARQL - Results","e":".srx"},"application/srgs":{"d":"Speech Recognition Grammar Specification","e":".gram"},"application/srgs+xml":{"d":"Speech Recognition Grammar Specification - XML","e":".grxml"},"application/ssml+xml":{"d":"Speech Synthesis Markup Language","e":".ssml"},"application/vnd.koan":{"d":"SSEYO Koan Play File","e":".skp"},"text/sgml":{"d":"Standard Generalized Markup Language (SGML)","e":".sgml"},"application/vnd.stardivision.calc":{"d":"StarOffice - Calc","e":".sdc"},"application/vnd.stardivision.draw":{"d":"StarOffice - Draw","e":".sda"},"application/vnd.stardivision.impress":{"d":"StarOffice - Impress","e":".sdd"},"application/vnd.stardivision.math":{"d":"StarOffice - Math","e":".smf"},"application/vnd.stardivision.writer":{"d":"StarOffice - Writer","e":".sdw"},"application/vnd.stardivision.writer-global":{"d":"StarOffice - Writer (Global)","e":".sgl"},"application/vnd.stepmania.stepchart":{"d":"StepMania","e":".sm"},"application/x-stuffit":{"d":"Stuffit Archive","e":".sit"},"application/x-stuffitx":{"d":"Stuffit Archive","e":".sitx"},"application/vnd.solent.sdkm+xml":{"d":"SudokuMagic","e":".sdkm"},"application/vnd.olpc-sugar":{"d":"Sugar Linux Application Bundle","e":".xo"},"audio/basic":{"d":"Sun Audio - Au file format","e":".au"},"application/vnd.wqd":{"d":"SundaHus WQ","e":".wqd"},"application/vnd.symbian.install":{"d":"Symbian Install Package","e":".sis"},"application/smil+xml":{"d":"Synchronized Multimedia Integration Language","e":".smi"},"application/vnd.syncml+xml":{"d":"SyncML","e":".xsm"},"application/vnd.syncml.dm+wbxml":{"d":"SyncML - Device Management","e":".bdm"},"application/vnd.syncml.dm+xml":{"d":"SyncML - Device Management","e":".xdm"},"application/x-sv4cpio":{"d":"System V Release 4 CPIO Archive","e":".sv4cpio"},"application/x-sv4crc":{"d":"System V Release 4 CPIO Checksum Data","e":".sv4crc"},"application/sbml+xml":{"d":"Systems Biology Markup Language","e":".sbml"},"text/tab-separated-values":{"d":"Tab Seperated Values","e":".tsv"},"image/tiff":{"d":"Tagged Image File Format","e":".tiff"},"application/vnd.tao.intent-module-archive":{"d":"Tao Intent","e":".tao"},"application/x-tar":{"d":"Tar File (Tape Archive)","e":".tar"},"application/x-tcl":{"d":"Tcl Script","e":".tcl"},"application/x-tex":{"d":"TeX","e":".tex"},"application/x-tex-tfm":{"d":"TeX Font Metric","e":".tfm"},"application/tei+xml":{"d":"Text Encoding and Interchange","e":".tei"},"text/plain":{"d":"Text File","e":".txt"},"application/vnd.spotfire.dxp":{"d":"TIBCO Spotfire","e":".dxp"},"application/vnd.spotfire.sfs":{"d":"TIBCO Spotfire","e":".sfs"},"application/timestamped-data":{"d":"Time Stamped Data Envelope","e":".tsd"},"application/vnd.trid.tpt":{"d":"TRI Systems Config","e":".tpt"},"application/vnd.triscape.mxs":{"d":"Triscape Map Explorer","e":".mxs"},"text/troff":{"d":"troff","e":".t"},"application/vnd.trueapp":{"d":"True BASIC","e":".tra"},"application/x-font-ttf":{"d":"TrueType Font","e":".ttf"},"text/turtle":{"d":"Turtle (Terse RDF Triple Language)","e":".ttl"},"application/vnd.umajin":{"d":"UMAJIN","e":".umj"},"application/vnd.uoml+xml":{"d":"Unique Object Markup Language","e":".uoml"},"application/vnd.unity":{"d":"Unity 3d","e":".unityweb"},"application/vnd.ufdl":{"d":"Universal Forms Description Language","e":".ufd"},"text/uri-list":{"d":"URI Resolution Services","e":".uri"},"application/vnd.uiq.theme":{"d":"User Interface Quartz - Theme (Symbian)","e":".utz"},"application/x-ustar":{"d":"Ustar (Uniform Standard Tape Archive)","e":".ustar"},"text/x-uuencode":{"d":"UUEncode","e":".uu"},"text/x-vcalendar":{"d":"vCalendar","e":".vcs"},"text/x-vcard":{"d":"vCard","e":".vcf"},"application/x-cdlink":{"d":"Video CD","e":".vcd"},"application/vnd.vsf":{"d":"Viewport+","e":".vsf"},"model/vrml":{"d":"Virtual Reality Modeling Language","e":".wrl"},"application/vnd.vcx":{"d":"VirtualCatalog","e":".vcx"},"model/vnd.mts":{"d":"Virtue MTS","e":".mts"},"model/vnd.vtu":{"d":"Virtue VTU","e":".vtu"},"application/vnd.visionary":{"d":"Visionary","e":".vis"},"video/vnd.vivo":{"d":"Vivo","e":".viv"},"application/ccxml+xml,":{"d":"Voice Browser Call Control","e":".ccxml"},"application/voicexml+xml":{"d":"VoiceXML","e":".vxml"},"application/x-wais-source":{"d":"WAIS Source","e":".src"},"application/vnd.wap.wbxml":{"d":"WAP Binary XML (WBXML)","e":".wbxml"},"image/vnd.wap.wbmp":{"d":"WAP Bitamp (WBMP)","e":".wbmp"},"audio/x-wav":{"d":"Waveform Audio File Format (WAV)","e":".wav"},"application/davmount+xml":{"d":"Web Distributed Authoring and Versioning","e":".davmount"},"application/x-font-woff":{"d":"Web Open Font Format","e":".woff"},"application/wspolicy+xml":{"d":"Web Services Policy","e":".wspolicy"},"image/webp":{"d":"WebP Image","e":".webp"},"application/vnd.webturbo":{"d":"WebTurbo","e":".wtb"},"application/widget":{"d":"Widget Packaging and XML Configuration","e":".wgt"},"application/winhlp":{"d":"WinHelp","e":".hlp"},"text/vnd.wap.wml":{"d":"Wireless Markup Language (WML)","e":".wml"},"text/vnd.wap.wmlscript":{"d":"Wireless Markup Language Script (WMLScript)","e":".wmls"},"application/vnd.wap.wmlscriptc":{"d":"WMLScript","e":".wmlsc"},"application/vnd.wordperfect":{"d":"Wordperfect","e":".wpd"},"application/vnd.wt.stf":{"d":"Worldtalk","e":".stf"},"application/wsdl+xml":{"d":"WSDL - Web Services Description Language","e":".wsdl"},"image/x-xbitmap":{"d":"X BitMap","e":".xbm"},"image/x-xpixmap":{"d":"X PixMap","e":".xpm"},"image/x-xwindowdump":{"d":"X Window Dump","e":".xwd"},"application/x-x509-ca-cert":{"d":"X.509 Certificate","e":".der"},"application/x-xfig":{"d":"Xfig","e":".fig"},"application/xhtml+xml":{"d":"XHTML - The Extensible HyperText Markup Language","e":".xhtml"},"application/xml":{"d":"XML - Extensible Markup Language","e":".xml"},"application/xcap-diff+xml":{"d":"XML Configuration Access Protocol - XCAP Diff","e":".xdf"},"application/xenc+xml":{"d":"XML Encryption Syntax and Processing","e":".xenc"},"application/patch-ops-error+xml":{"d":"XML Patch Framework","e":".xer"},"application/resource-lists+xml":{"d":"XML Resource Lists","e":".rl"},"application/rls-services+xml":{"d":"XML Resource Lists","e":".rs"},"application/resource-lists-diff+xml":{"d":"XML Resource Lists Diff","e":".rld"},"application/xslt+xml":{"d":"XML Transformations","e":".xslt"},"application/xop+xml":{"d":"XML-Binary Optimized Packaging","e":".xop"},"application/x-xpinstall":{"d":"XPInstall - Mozilla","e":".xpi"},"application/xspf+xml":{"d":"XSPF - XML Shareable Playlist Format","e":".xspf"},"application/vnd.mozilla.xul+xml":{"d":"XUL - XML User Interface Language","e":".xul"},"chemical/x-xyz":{"d":"XYZ File Format","e":".xyz"},"text/yaml":{"d":"YAML Ain't Markup Language / Yet Another Markup Language","e":".yaml"},"application/yang":{"d":"YANG Data Modeling Language","e":".yang"},"application/yin+xml":{"d":"YIN (YANG - XML)","e":".yin"},"application/vnd.zul":{"d":"Z.U.L. Geometry","e":".zir"},"application/zip":{"d":"Zip Archive","e":".zip"},"application/vnd.handheld-entertainment+xml":{"d":"ZVUE Media Manager","e":".zmm"},"application/vnd.zzazz.deck+xml":{"d":"Zzazz Deck","e":".zaz"}}"#;

#[wasm_bindgen]
pub fn read_at_offset_sync(file: web_sys::File) -> Result<JsValue, Error> {
    let mut file_attrs = FileAttrs::default();
    let ftype = &file.type_();
    let flast_modified = file.last_modified();
    let fname = file.name();
    file_attrs.name = Some(fname);
    file_attrs.last_modified = flast_modified;
    file_attrs.size = file.size();
    file_attrs.size_human = Some(convert(file.size()));
    let mut wf = WebSysFile::new(file);
    let mut buf = [0; 200];
    let result = wf.read_exact(&mut buf);
    match result {
        Ok(_) => {}
        Err(_) => return serde_wasm_bindgen::to_value(&file_attrs),
    };
    let result = infer::get(&buf);
    let result = match result {
        Some(tye) => tye.mime_type(),
        None => &ftype,
    };
    file_attrs.mime = Some(String::from(result));
    return serde_wasm_bindgen::to_value(&file_attrs);
}

#[derive(Default, Serialize, Deserialize)]
struct FileAttrs {
    name: Option<String>,
    mime: Option<String>,
    last_modified: f64,
    size: f64,
    size_human: Option<String>,
}

pub fn convert(num: f64) -> String {
    let negative = if num.is_sign_positive() { "" } else { "-" };
    let num = num.abs();
    let units = ["B", "kB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"];
    if num < 1_f64 {
        return format!("{}{} {}", negative, num, "B");
    }
    let delimiter = 1000_f64;
    let exponent = cmp::min((num.ln() / delimiter.ln()).floor() as i32, (units.len() - 1) as i32);
    let pretty_bytes = format!("{:.2}", num / delimiter.powi(exponent)).parse::<f64>().unwrap() * 1_f64;
    let unit = units[exponent as usize];
    format!("{}{} {}", negative, pretty_bytes, unit)
  }